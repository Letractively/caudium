Changes in Caudium 1.5.1 since Caudium 1.4.1
---------------------------------------------
- Impliment an additional ABS check that should catch blocked servers
   while running in threaded mode that traditional ABS would not detect.
  (Bill Welliver
- Better handling of AJP containers that don't keep track of POST data 
   they've already received, as well as better indications of situations 
   where a POST size limitation has occurred.
  (Bill Welliver)
- Fix a bug that causes Request_Id->site_id to not be updated when using
   ip-less virtual hosting. Should fix odd behavior problems when using
   try_get_file(), such as <insert file> and many other situations.
  (Bill Welliver)
- Removed a number of unsupported modules:
    ultralog
    proxies/ftpgateway
    proxies/connect
    perl
    unfinishedmodules
   (Bill Welliver)
- Response generation and sending for HTTP and SSL protocols have been
   consolidated, resulting in (hopefully) much more consistent results
  (Bill Welliver)
- Add support for not URL encoding requests when using AJP. This should 
   allow AJP to work better for containers that expec this (newer 
   Tomcats, flup on Python, etc)
  (Bill Welliver)
- Add checks to prevent a user from deleting the Configuration Interface
   virtual server (a config named "ConfigurationInterface") from within 
   the CIF.
  (Bill Welliver)
- Fixes for running Caudium using Pike 7.8
  (Bill Welliver)
- Added --dtruss support (MacOS X 10.5)
  (Bertrand LUPART)
- Fixed a bug in gtext that would try to parse the empty tag (<>) if list of
  tags to get colors from was left empty in the CIF. This used to break
  javascript code.
  (Closes Google issue #4)
  (Bertrand LUPART and Bill Welliver)
- Make the watchdog more verbose in case it has to kick in in GET mode.
  (Bertrand LUPART)
- CIF documentation about module priorities made more clear.
  Reversed order of the select list: highest priority now on top.
  (Bertrand LUPART and Benjamin GANDON)
- Caudium now display the error code and message when it can't talk to the
  watchdog.
  (Bertrand LUPART)
- Caudium RC script now display Caudium startup error if any and just tell if
  startup failed.
  (Bertrand LUPART) 
- Redirects from 123session module should mangle the original URL less
  when browsing without cookies.
  (Bill Welliver with Dave Walton)
- Caudium modules now use pike -x module for building.
  (Bill Welliver)
- Caudium.HTTP.set_cookie() added for setting a cookie to the browser.
  <set_cookie> now use it.
  (Bertrand LUPART)
- Caudium.sexpr_eval("10 + 1") and Caudium.sexpr_eval("1+1") now produce the
  expected result.
  (Closes Google issue #2)
  (Bertrand LUPART)
- install app should get proper executable permissions
  (Bill Welliver)
- install app starts caudium in --once mode, which is more friendly if 
  there's a problem starting up.
  (Bill Welliver)
- configvar is no more (script is in bin but is non-working)
  (Bill Welliver)
- Proxies: Relay module (relay2.pike) now passes X-Forwarded-For
  header to destination.
  (Bill Welliver)
- Added new upgrade support system. Allows multiple installation or 
  virtual server upgrade tasks to be performed per version.
  (Bill Welliver)
- Fixed encoding generated by  _Caudium.*_encode_mapping() and 
  _Caudium._make_container_attributes().
  (Bill Welliver) 
- Fixed _Caudium.http_encode_url test (we were testing behavior that wasn't 
  documented and may be undesirable)
  (Bill Welliver)
- Only consider specified pike when using --with-pike rather than also 
  checking a list of possible pike locations.
  (Bill Welliver and Martin Baehr)
- Added --with-any-pike-version to disable standard version compatibility
  (Bill Welliver and Martin Baehr)
- file_stat() is now just standard Pike (returns Stdio.Stat object)
  rather than an array.
  (Bill Welliver)
- Xenofarm builds can be modified using:
  CONFIGURE_ARGS (already present)
  MAKE_ARGS (just added)
  These arguments can be passed on the action line in your xenofarm  
  project cfg file.
  (Bill Welliver)
- Data returned from a scope entity will be cast to a string, allowing
  potentially mixed datasets to be returned for use by emit and friends.
  (Bill Welliver)
- New demo certificate with extended expiration date.
  (Henrik Andreasson)
- Fixed some rimage plugins with wrong Colors.parse_color() calls.
  (Bertrand LUPART)
- Fixed a bug in rimage.pike than prevented plugins to be loaded.
  Available modules and currently loaded modules are now shown in module status.
  (Bertrand LUPART)
- Avoid a backtrace when <cimg> is called without src atrribute.
  (Bertrand LUPART)
- Using <insert file="foo.php"> and setting up Uniscript to parse RXML in PHP's
  result won't freeze your server anymore.
  This feature should be still discussed.
  (Bertrand LUPART)
- PATH_INFO how allows to pass variables into URL like:
  http://domain.tld/file.html/foo=bar/baz=gazonk
  Those are stored into id->misc->path_info_variables and
  id->misc->path_info_variables id->misc->path_info_empty_variables
  (Bertrand LUPART)
- Added CAUDIUM_SITE_ID environment variables for being able to get it 
  from external scripts.
  (Bertrand LUPART)
- Added RequestID()->get_canonical_url(), which should be used
    by any code attempting to determine the "official" url of the 
    current virtual server.
    (Bill Welliver)
- Fix for using domain cookies with 123session and ports that are non-
   standard (ie other than 80 and 443).
   (Bill Welliver)
- Fix XML encoding of strings in _Caudium.xml_encode_mapping and friends.
    (Bill Welliver with Bertrand LUPART)
- Add missing characters to HTML encoding list.
    (Bill Welliver with Bertrand LUPART)
- Fix CGI processing for POSTs when running under Shuffler.
    (Bill Welliver)
- Testing out a new cache expiration technique that doesn't involve
    large amounts of I/O. This should reduce occurances of runaway
    cache expiration as well as file descriptor shortages.
    (Bill Welliver)
- Error Log tab now only stores the most recent 250 items. This should 
   prevent a source of constantly growing memory usage.
   (Bill Welliver)
- New option --with-pike-module in start-caudium allows to specify some more
  Pike modules to load at start time.
   (Bertrand LUPART)
- Added randomization to cache and storage jobs to prevent surges.
    (Bill Welliver)
- We now store cache item sizes, which should reduce fd usage and
    improve startup times.
    (Bill Welliver)
- Removed a double read on cache items, which should improve performance.
    (Bill Welliver)
- Cache tuning to prevent runaway cache expiration.
    (Bill Welliver)
- Default maximum POST size is now 5MB for new virtual servers.
    (Bill Welliver)
- An error 413 is returned for requests crossing the maximum POST size,
    even though it may be interpreted as a "premature close".
    (Bill Welliver)
- Config interface variables pertaining to cache storage engine now use
    SQL instead of MySQL.
    (Bill Welliver)
- Storage.Methods.MySQL is now Storage.Methods.SQL in honor of its newly 
    found cross-databasiness, which includes support for SQLite.
    (Bill Welliver)
- User listing toggle in User Filesystem works more properly.
    (Bill Welliver)
- Fixes for authentication providers that don't support user listings
    (Bill Welliver)
- Added a "null" slow storage backend for cache.
    (Bill Welliver)
- Fix color selector for wizards.
    (Bill Welliver)
- Make running with Shuffler the default.
    (Bill Welliver)
- Rework the module add page to make it load faster and look better.
    (Bill Welliver)
- Reverting to Pike language prestate parser; disable use of "internal" 
    prestates.
    (Bill Welliver)
- CIF pages using the wizard form now sport a unique identifier in the request
  so that the page is still up to date, even with browsers that caches a lot.
   (Bertrand LUPART)
- The CIF can now show if the server is running with Shuffler or nbio.
   (Bertrand LUPART)
- Fixed a bug where empty variables passed in the URL would totally mess up the
  other variables and empty variables in the request id object.
   (Bertrand LUPART)
- Client certificate request support added. We can specify a set of issuers
    and a root authority chain. We still need a module to equate the client
    certificate with a user.
    (Bill Welliver)
- Multi-User aware configuration interface.
    (Bill Welliver)
- Configuration Interface is now a regular virtual server.
    (Bill Welliver)
- Added PAM Authentication provider; requires System.PAM module.
    (Bill Welliver)
- Requests on the same 1st level virtual host can now be splitted into
  different logfiles given the virtual host domain used in the HTTP request.
    (Bertrand LUPART / Olivier CHENEL)
- <scut cut_on_whites="1"></scut> ask scut to only cut on whitespaces. The
  goal is not to cut words.
  The module can be configured to do this by default in the CIF.
  Not enabled by default for backward compatibility.
    (Bertrand LUPART)
- <scut htmlencode="1"></scut> won't encode string in HTML. Volontary not
  documented on the user side, since that's not percieved as a good practice.
  See scut.pike source code for enabling this.
    (Bertrand LUPART)
- Fix to destroy file objects after the request is sent when using shuffler.
  This should fix a problem with running out of file descriptors. Also, a 
  patch was applied to Pike 7.6 CVS to fix a crash caused by using shuffler.
    (Bill Welliver)
- <cimg> now append the original image filename to the internal path, so that
  the webcrawlers can still index a <cimg> processed image.
    (Bertrand LUPART)
- The CIF can now show the system limits set for Caudium.
  See http://bertrand.gotpike.org/space/start/2006-02-27/1 for more
  informations.
    (Bertrand LUPART)
- Fixed cgi when USE_SHUFFLER is used.
    (Bill Welliver)
- Added quiet option to EMIT SQL, so that sql backtraces don't get
  sent to the browser.
    (Bill Welliver)
- Added quoting capabilities to EMIT, so that you can do &foo.bar:mysql;
  to get your entity replacements properly quoted.
    (Bill Welliver)
- 123sessions: added force_include_urls to be able to specify urls you 
  wish to trigger a redirect to include the session identifier. if left 
  empty, normal behavior is used. this augments include_urls and exclude 
  urls, which are used to specify url subtrees where session processing 
  is either performed or not performed.
    (Bill Welliver)
- Fixed a few leaks in Caudium.make_tag_attributes() and encode_mapping()
   and optimized them a bit, which should plug a fast growing leak when
   using <define>
    (Bill Welliver)
- Added --with-shuffler and --shuffler options for running with
   Pike Shuffler 
    (Bertrand LUPART)
- Fixed a bug where some CGI/uniscript pages where not fully displayed to the
   client. See http://bertrand.gotpike.org/space/start/2006-02-15/1 for more 
   informations.
   (Bertrand LUPART)
- Fixed a Virtual Host Matcher bug where the port number was not properly 
   identified from the hostname.
   (Bernd Shoeller)
- Fixed some Caudium.nbio code that where still used in socket.pike
   (Xavier Beaudouin)
- Properly decode UTF-8 requests that have been HTTP encoded.
   (Bill Welliver)
- Fix for the 2GB file limit in Caudium.nbio, which should allow
   big files to be transmitted now.
   (Bill Welliver)
- Fix in protocols/http that inadvertantly caused modules using
   HTTP.pipe_in_progress() to drop the connection with the client.
   In particular, this should fix problems in proxy modules,
   but other modules may see an impact as well.
   (Bill Welliver)
- Streaming mode now works in HTTP Relay Module.
   (Bill Welliver)
- Added support for Bonjour Advertisement of virtual servers. 
   Available under Virtual Server Global Variables. Uses either
   the virtual server config name, or the "virtual server name" 
   setting under Global Variables (click on "More Options to 
   show this option.) Available when Pike is compiled with
   DNS_SD support, available on MacOSX/Darwin and systems with
   Howl installed.
   (Bill Welliver)
- Added new showcolumns argument for <sqltable> (Caudium bug id #19, patch
  by Hex).
   (Xavier Beaudouin)
- Fixed errors in russian translations (Caudium bug id #18)
   (Xavier Beaudouin)
- Fixed _Caudium C module to compile with a non threaded Pike.
   (Xavier Beaudouin / Michel Luczak) 
- FastCGI module automatically kills any FastCGIs it created when 
   the module stops. This should eliminate "stranded" FCGIs.
   (Bill Welliver)
- Fixes for <user> tag when working with new authentication system.
   (Bill Welliver)
- Group functionality can be disabled in SQL Authentication Provider
   (Bill Welliver)
- Added vhs_syslogger module to log using Syslog to local or distant host
   (Xavier Beaudouin)
- Fixed bug #17 (ultralog not working on 1.5)
   (Xavier Beaudouin)
- Fixed syslog to work as it is advertized on CIF
   (Xavier Beaudouin)
- Fixed emit->maxrows and emit->skiprows
   (Bill Welliver)
- Added emit->sort_function and emit->sort_key to sort query results
   Example usage: sort_function="Array.oid_sort_func" sort_key="version"
   where sort_function is the name of a function compatible with 
   Array.sort_array, and sort_key is the name of a field in the resultset 
   to sort by.
   (Bill Welliver)
- Backported VHS SQLogger from 1.2. Same warnings as for 1.4 branch....
   (Xavier Beaudouin)
- Fixed bug #11
   (Xavier Beaudouin)
- Because of changes in Pike 7.6.24+ that have been not compatible with
  it self, we requires now 7.6.24 now.
   (Xavier Beaudouin)
- Fix installation script that has been stop to work with pike 7.6.24+
   (Xavier Beaudouin)
- Add Index redirect files option that allow people that use L7 load balancers
  to redirect to files that have been specified instead of listing the
  directory.
   (Xavier Beaudouin)
- Fix error on vhs_dirparser when there is no files on directory and that
  option "show dot files" is set to no
   (Xavier Beaudouin)
- The watchdog now really take care of the port configuration for each virtual
  server instead of guessing it from the server URI. As a consequence, the
  watchdog can now check multiple HTTP ports for a virtual server.
  Checks are made on the protocol used as well as on the binded interface
  before adding a new virtual server/port to the watch list.
  This fixes a bug where the watchdog would restart Caudium ever and ever on a
  fresh install until some virtual server binds to the port 80.
   (Bertrand LUPART)
- Fixed a watchdog backtrace on fresh install when there are no virtual server
  set up in the CIF, yet.
   (Bertrand LUPART)
- Starting Caudium with --gdb now turns the watchdog off.
   (Bertrand LUPART)
- Some work on accessed-sql:
  - now 2nd level virtual hosting safe
	- fix for a first loading bug that required to restart Caudium
	- now possible to use <counter add="0"> for not incrementing the counter
   (Bertrand LUPART)
- _Caudium.getip() call to get interfaces names and ips for *BSD flavors.
   (Xavier Beaudouin)
- <if> no longer evaluates true if using the "element is value" syntax and the
  element is not present.
   (Bill Welliver)
- Fixed a backtrace during load of the WebApp module.
   (Bill Welliver)
- Watchdog debug can be enabled using --watchdog-debug
   (Bertrand Lupart)
- If set using HTTP GET, the watchdog can now be set up either to check every
  1st level virtual server or either only the first one.
   (Bertrand Lupart)
- The watchdog can now check virtual servers using HTTP GET
   (Bertrand Lupart)
- The id->variables isn't set as before regarding variables with emtpy values,
  this broke the screen for adding a new virtual server.
   (Bertrand Lupart)
- Watchdog PID check can now be disabled with --without-watchdog-pidcheck
  It is disabled by default on Linuxes < 2.6, since their threads
  implementations assigned different PIDs for each thread.
   (Bertrand Lupart)
- Fixed backtrace when using <accessed since> or <accessed help> when accessed
  was handled by accessed-sql or accessed-memory.
   (Bertrand Lupart)
- Not using strftime on solaris as it does not support the POSIX %z flag
  which rendered Caudium.cern_http_date() unusable.
   (Marek Habersack)
- The id->variables wasn't set as before regarding empty values, this broke
  some applications and most notably lead to internal server error when
  reseting a variable in the configuration interface.
   (David Gourdelier)
- Comparing of empty strings didn't work in RXML so this lead to wrong
  <if match...>
   (David Gourdelier)
- Fix for the RXML parsers sending the wrong content-type header when parsing
  a non-html document.
   (James Tyson)
- Pikegraphy now likes filenames with spaces.
   (Bill Welliver)
- Watchdog should now work with servers that change uid.
   (Bill Welliver)
- Stopping/restarting of server should work properly now, especially for servers that change uid.
   (Bill Welliver)
- Fix a backtrace in Config-Action openports when there is no lsof located 
  on the hosted machine.
   (Xavier Beaudouin)
- Fixed loading of Crypto related Configuration Actions in CIF.
   (Xavier Beaudouin)
- Fixed a segfault in Caudium C module when broken variable assignments
  in the query part of the url are parsed (eg ?foo=too&hop=&gazon=zz - hop= 
  is the invalid syntax), SF bug #1028622
   (Marek Habersack)
