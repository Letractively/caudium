MODNAME=PiXSL
OBJS= sablot.o
SOURCES=sablot.c
CFLAGS= @CPPFLAGS@ @CFLAGS@ -I@PIKE_INCLUDE_DIR@
CC=@CC@
LDFLAGS=@LIBS@ @LDFLAGS@ 
LIBGCC=@LIBGCC@
LD= @LDSHARED@
PIKE=@PIKE@
SO=@SO@
all: $(MODNAME).$(SO)
INSTALLDIR=@PIKE_MODULE_DIR@
INSTALL=@INSTALL@

all:  Makefile.pre $(MODNAME).$(SO)

.SUFFIXES: .c .o

force:
	@:

install: all
	-strip $(MODNAME).$(SO)
	$(INSTALL) $(MODNAME).$(SO) $(INSTALLDIR)

$(MODNAME).$(SO): $(OBJS)  $(MODULE_ARCHIVES)
	@echo "linking $(MODNAME)" ;\
	if @LDSHARED@ $(LDFLAGS) -o $(MODNAME).$(SO) $(OBJS) $(MODULE_LDFLAGS) $(LIBGCC) -lc $(LIBGCC) ; then \
	  : ; \
	else \
	  echo "Linking failed:" >&2; \
	  echo @LDSHARED@ $(LDFLAGS) -o $(MODNAME).$(SO) $(OBJS)  $(MODULE_LDFLAGS) $(LIBGCC) -lc $(LIBGCC) >&2 ;\
	fi
Makefile.pre: Makefile.pre.in configure config.status
	@echo "configure or Makefile.in changed."
	@if test -f config.status; then \
           echo -n "Rebuilding Makefile myself using: ";\
	   echo "`head config.status|grep 'configure '|tr '#' ' '` "; \
	   eval "`head config.status|grep 'configure '|tr '#' ' '` "; \
	   echo "$@";\
           echo "You must rerun make now"; exit 1;\
	else\
	   echo "You must rerun configure now."; \
	   exit 1; \
	fi

.SUFFIXES: .c .o

.c.o:
	$(CC) $(CFLAGS) -c $< -o $@ 


configure: configure.in
	@echo "configure.in changed. Rebuilding."
	@autoconf

config.status: configure
	./config.status --recheck

depend:  force
	@echo "Calculating dependencies..."
	@cat Makefile.pre >  Makefile
	@$(CC) -MM $(CFLAGS) *.c >> Makefile

clean:
	rm -f *.o *~ $(MODNAME).$(SO) 

distclean: clean
	rm -f config.* Makefile Makefile.pre dependencies sablot_config.h

spotless: distclean
	rm -f configure  sablot_config.h.in

# Dependencies goes here...

